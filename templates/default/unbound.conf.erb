# Unbound configuration file for Debian.
# <% if node.has_key?('chef') and node['chef'].has_key?('template_warning') -%><%= "\n##{node['chef']['template_warning']}\n#\n"%><%- end %>
# See the unbound.conf(5) man page.
#
# See /usr/share/doc/unbound/examples/unbound.conf for a commented
# reference config file.

server:
    val-log-level: 2    

    verbosity: 1
    do-ip6: <%= @ipv6?'yes':'no' %>

    <% if node[:unbound][:dnssec][:enable] %>
    # The following line will configure unbound to perform cryptographic
    # DNSSEC validation using the root trust anchor.
    auto-trust-anchor-file: "/var/lib/unbound/root.key"
    <% @insecure_domains.each do |domain| -%>
    domain-insecure: "<%= domain %>"
    <%- end %>
    <% end %>
    <% if node[:unbound][:caching] %>
forward-zone:
    name: "."
    forward-addr: 140.181.96.11  # lxdns1.gsi.de
    forward-addr: 140.181.96.29  # lxdns2.gsi.de
    <% else %>
    <% @stub_zones.each do |name,config| -%>
stub-zone:
    name: "<%= name %>"
    stub-addr: <%= config[:server] %>
    <%- end %>
    <% end %>

