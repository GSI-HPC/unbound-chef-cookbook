# THIS FILE HAS BEEN GENERATED BY CHEF
# ANY MANUAL MODIFICATIONS WILL BE OVERWRITTEN
# (managed by the unbound cookbook)

# Unbound configuration file for Debian.
#
# See the unbound.conf(5) man page.
#
# See /usr/share/doc/unbound/examples/unbound.conf 
# for a commented reference config file.

server:
    val-log-level: 2    

    verbosity: 1
    do-ip6: <%= @ipv6?'yes':'no' %>

    <% if node[:unbound][:dnssec][:enable] %>
    # Ignore the DNSSEC chain of trust for the
    # following domains:
    <% @insecure_domains.each do |domain| -%>
    domain-insecure: "<%= domain %>"
    <%- end %>
    <% end %>

    <% if (!node[:unbound][:interfaces].nil?) %>
    <% node[:unbound][:interfaces].each do |interface_ip| -%>
    interface: <%= interface_ip %>
    <%- end %>
    <% end %>

    <% if node[:unbound][:caching] %>
forward-zone:
    name: "."
    <% @forwarders.each do |srv_ip| -%>
    forward-addr: <%= srv_ip %>  
    <%- end %>
    <% else %>
    <% @stub_zones.each do |name,config| -%>
stub-zone:
    name: "<%= name %>"
    stub-addr: <%= config[:server] %>
    <%- end %>
    <% end %>

